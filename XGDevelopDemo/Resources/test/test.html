<!DOCTYPE html>
<!-- saved from url=(0043)http://202.91.249.116:8092/webApp/test.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <title>测试</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">
    <meta name="format-detection" content="email=no">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0">
    <script src="jquery.min.js"></script>
    <script>


        //初始化
        $(function () {
            // 设置标题
            $("#test").click(function () {
                if (window.WebViewJavascriptBridge) {
                    window.WebViewJavascriptBridge.callHandler('_app_setTitle', '我是标题啊', function(responseData) {
                        document.getElementById("show").innerHTML = ("title set: " + responseData);
                    });
                }
            });

            // 扫一扫
            $("#scan").click(function () {
                window.WebViewJavascriptBridge.callHandler('_app_getCodeScan', '', function(responseData) {
                    document.getElementById("show").innerHTML = ("scan callback data:" + responseData);
                });
            });

            // 查看图片
            var imgss = [];
            $(".pointexchange img").each(function (i) {
                imgss.push("http://202.91.249.116:8092/webApp/img/" + $(this).attr("title"));
                $(this).click(function () {
                    window.WebViewJavascriptBridge.callHandler('_app_getImages',
                    { 'imgaes': imgss, 'currentIndex': i },
                    function(responseData) {
                        document.getElementById("show").innerHTML = ("images callback data:" + responseData);
                    });
                })
            });

            function connectWebViewJavascriptBridge(callback) {
                if (window.WebViewJavascriptBridge) {
                    callback(WebViewJavascriptBridge)
                } else {
                    document.addEventListener(
                        'WebViewJavascriptBridgeReady'
                        , function() {
                            callback(WebViewJavascriptBridge)
                        },
                        false
                    );
                }

                if (window.WVJBCallbacks) { return window.WVJBCallbacks.push(callback); }
                window.WVJBCallbacks = [callback];
                var WVJBIframe = document.createElement('iframe');
                WVJBIframe.style.display = 'none';
                WVJBIframe.src = 'wvjbscheme://__BRIDGE_LOADED__';
                document.documentElement.appendChild(WVJBIframe);
                setTimeout(function() { document.documentElement.removeChild(WVJBIframe) }, 0)
            }

            connectWebViewJavascriptBridge(function(bridge) {
                console.log('callback called');
                bridge.init();

                bridge.registerHandler('getCodeScan', function(data, responseCallback) {
                    console.log('getCodeScan');
                    document.getElementById("show").innerHTML = ("data from client: = " + data);
                    responseCallback('getCodeScan');
                })
            });
        })

    </script>

    <style>
        html {
            font-family: Helvetica;
            color: #222;
        }

        h1 {
            color: steelblue;
            font-size: 24px;
            margin-top: 24px;
        }

        button {
            margin: 0 3px 10px;
            font-size: 12px;
        }

        .logLine {
            border-bottom: 1px solid #ccc;
            padding: 4px 2px;
            font-family: courier;
            font-size: 11px;
        }

        input {
            height: 32px;
            margin: 30px;
        }
    </style>
</head>
<body data-feedly-mini="yes">

    <div id="buttons"></div>
    <div id="log"></div>
    <div class="pointexchange">
        <div>
            <img src="./test_files/points4.png" width="47px" height="47px" title="points4.png"><br>
            <label>积分兑换实物</label>
        </div>
        <div>
            <img src="./test_files/points1.png" width="47px" height="47px" title="points1.png"><br>
            <label>积分兑换红包</label>
        </div>
        <div>
            <img src="./test_files/points2.png" width="47px" height="47px" title="points2.png"><br>
            <label>积分参与活动</label>
        </div>
    </div>
    <!--  <input type="button" onclick="UamaJSBridge._app_setTitle('涓枃ss')" value="test鏍囬--UamaJSBridge" />-->
    <br>
    <input id="test" type="button" value="设置标题">
    <br>
    <!--<input type="button" onclick="UamaJSBridge._app_openCloseBtn()" value="openCloseBtn" />-->
    <br>
    <input type="file" value="上传">
    <br>

    <input id="scan" type="button" value="扫一扫">
    <div id="show">
    </div>


</body>
</html>
